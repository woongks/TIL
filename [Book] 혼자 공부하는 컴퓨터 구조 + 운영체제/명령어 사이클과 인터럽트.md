## 명령어 사이클과 인터럽트

CPU가 하나의 명령어를 처리하는 과정에는 정해진 흐름이 있다. 이 정형화된 흐름을 명령어 사이클이라고 한다.

그리고 간혹 이 사이클의 흐름이 끊기는 현상이 발생하는데, 이를 인터럽트라고 한다.

명령어를 실행하려면 일단 명령어를 메모리에서 CPU로 갖고 와야 한다.
메모리에 있는 명령어를 CPU로 갖고 오는 단계를 **인출 사이클**이라고 한다.

명령어를 실행하는 단계를 **실행 사이클**이라고 한다. 제어장치가 명령어 레지스터에 담긴 값을 해석하고 제어 신호를 발생시킨다.

보통의 프로그램은 인출과 실행 사이클을 반복하면서 명령어를 실행한다.

만약에 간접 주소 지정 방식을 사용한다면 주소를 한 번 더 접근하는 과정을 거쳐야 한다. 이 단계를 **간접 사이클**이라고 한다.

이러한 사이클을 거치다 작업을 방해하는 신호가 나오는 경우가 생긴다. 이 신호를 **인터럽트**라고 한다.

인터럽트는 크게 **동기 인터럽트**와 **비동기 인터럽트**가 있다.

동기 인터럽트는 CPU에 의해 발생된다. CPU가 명령어를 수행하다가 예상하지 못한 상황에 놓이는 경우 발생한다. 이 동기 인터럽트는 **예외**라고 부르기도 한다.

비동기 인터럽트는 주로 입출력장치에 의해 발생하는 인터럽트다. 작업이 완료된 후 입출력장치에 의한 알림과 같은 역할을 한다. ( 하드웨어 인터럽트라고도 한다.)

하드웨어 인터럽트는 CPU가 입출력 작업 중에도 다른 명령어를 효율적으로 처리하기 위해 필수적이다.

#### 하드웨어 인터럽트 처리 순서

> 입출력장치가 CPU에 인터럽트 요청 신호를 보낸다. (인터럽트를 해도 되는지 CPU한테 물어보는 것)
> CPU는 실행 사이클이 끝나고 명령어를 인출하기 전에 인터럽트 여부를 확인한다.
> CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부를 확인한다. (지금 작업이 인터럽트를 해도되는 작업이면 플래그가 '가능'으로 설정되어 있을 것이고 인터럽트를 할 수 없는 중요한 작업이면 플래그가 '불가능'으로 설정되어 있을 것이다.)
> 인터럽트를 받아들일 수 있다면 CPU는 지금까지의 작업을 백업한다.
> CPU는 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴을 실행한다.
> 수비스 루틴 실행이 끝나면 백업해 둔 작업을 복구하여 실행을 재개한다.

##### 모든 하드웨어 인터럽트를 인터럽트 플래그로 막을 수 있는 것은 아니다.

> 정전이나 하드웨어 고장으로 인한 인터럽트 같은 경우 플래그로 막을 수 없다.
