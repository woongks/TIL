# 필기

1. 노드는 자바스크립트 런타임이다.

- 런타임이란 특정 언어로 만든 프로그램들을 실행할 수 있는 환경을 뜻한다.
- 따라서 노드는 자바스크립트 실행기라고 볼 수 있다.

2. 노드는 V8 엔진과 libuv라는 c,c++ 기반 라이브러리를 사용한다.

- 이 libuv 라이브러리는 노드의 특성인 이벤트 기반, 논 블로킹 I/O 모델을 구현한다.

3. 이벤트 기반은 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식을 의미한다.

- 예시로 클릭 혹은 네트워크 요청 등이 있다.

4. 이벤트 루프

- 노드는 자바스크립트 코드 맨 위부터 한 줄씩 실행한다.
- 함수 호출 부분을 발견했다면 호출한 함수를 호출 스택에 넣는다.
- 이 스택이 호출된 콜백 함수의 실행 순서를 결정한다.

5. 백그라운드

- setTimeout 같은 타이머나 이벤트 리스너들이 대기하는 곳. 여러 작업이 동시에 실행될 수 있다. (JS가 아닌 다른 언어로 작성된 프로그램이라고 봐도 됨)
- 백그라운드에서 시간이 진행된다.

6. 태스크 큐

- 이벤트 발생 후, 백그라운드에서는 태스크 큐로 타이머나 이벤트 리스너의 콜백 함수를 보낸다. 태스크 큐를 콜백 큐라고 하기도 한다.

7. 호출 스택, 백그라운드, 태스크 큐 동작

- 호출 스택이 비워지면 이벤트 루프가 태스크 큐의 콜백을 호출 스택으로 올린다.
- 호출 스택에 함수가 많이 들어있으면 setTimeout이 정확히 동작하지 않을 수도 있다.

8. 논 블로킹 I/O

- 작업이 끝날 때까지 대기하지 않고 다음 작업을 수행하는 것.
- 노드는 자바스크립트 상에서 돌아가는 것이 아닌 I/O 작업 같은 것을 논 블로킹으로 처리한다.
- I/O 작업을 백그라운드로 넘겨 동시에 처리하는 것이다.
- 파일 시스템 접근(파일 읽기, 쓰기, 폴더 만들기)이나 네트워크를 통한 요청 같은 작업이 I/O의 일종이다.
- 논 블로킹을 구현하기 위해 setTimeout(콜백, 0) 을 쓰기도 한다.
- 위의 코드를 쓰면 대기 시간이 0밀리초라도 동작 시간이 소요되기 때문에 딜레이가 생겨서 우선순위가 뒤로 밀린다.
- 브라우저에서는 4ms, 노드에서는 1ms의 지연 시간이 있다.

9. 프로세스

- 프로세스는 운영체제에서 할당하는 작업의 단위다.
- 노드나 웹 브라우저는 개별적인 프로세스다. 프로세스 간에는 메모리 등의 자원을 공유하지 않는다.

10. 스레드

- 스레드는 프로세스 내에서 실행되는 흐름의 단위다.
- 프로세스는 스레드를 여러 개 생성해서 여러 작업을 동시에 처리할 수 있다.
- 스레드끼리 자원의 공유가 가능하다.
- 노드도 여러 개의 스레드로 동작하지만 직접 제어할 수 있는 스레드는 하나이기 때문에 보통 싱글 스레드라고 한다.

11. 노드가 싱글 스레드로 동작하지 않는 두 가지 경우를 스레드풀, 워커 스레드라고 한다.

- 스레드풀은 노드가 특정 동작을 수행할 때 스스로 멀티 스레드를 사용한다. 대표적인 예로 암호화, 파일 입출력, 압축 등이 있다.
- 워커 스레드는 노드 12 버전에서 안정화된 기능으로 노드에서 멀티 스레드를 구현할 수 있게 한다.
- 멀티 스레드 방식으로 프로그래밍하는 것은 어려우므로 멀티 프로세싱 방식을 선호한다. I/O 요청에는 멀티 프로세싱이 더 효율적이다.

11. 서버로서의 노드

- 개수는 많지만 크기는 작은 데이터를 실시간으로 주고받는 데 적합하다.
- 실시간 채팅 어플, 주식 차트, JSON 데이터를 제공하는 API 서버 등에 적합하다.
- 멀티 스레드 기능이 있어도 이미지나 비디오 처리, 대규모 데이터 처리처럼 CPU를 많이 사용하는 작업을 위한 서버로는 권장하지 않는다.
- 노드로 이를 구현하려면 AWS 람다나 구글 클라우드 펑션스 같은 서비스에서 노드로 CPU를 많이 사용하는 작업을 처리할 수 있다.
