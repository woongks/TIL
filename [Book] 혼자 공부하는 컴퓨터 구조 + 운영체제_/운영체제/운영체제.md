### 운영체제를 알아야 하는 이유

실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램이 운영체제다.

운영체제는 여느 프로그램과 마찬가지로 메모리에 적재되어야 한다.
하지만 특별한 프로그램이기 때문에 컴퓨터가 부팅될 때 메모리 내 커널 영역이라는 공간에 따로 적재되어 실행된다.

커널 영역을 제외한 나머지 영역, 사용자가 이용하는 응용 프로그램이 적재되는 영역을 사용자 영역이라고 한다. 즉, 운영체제는 커널 영역에 적재되어 사용자 영역에 적재된 프로그램들에 자원을 할당하고 이들이 올바르게 실행되도록 돕는다.

운영체제는 실행할 프로그램을 메모리에 적재하고, 더 이상 실행되지 않는 프로그램을 메모리에서 삭제하며 지속적으로 메모리 자원을 관리한다.

또 운영체제는 프로그램들에게 공정하게 CPU 자원을 할당한다.

운영체제는 관리할 자원별로 기능이 나누어져 있다.

운영체제는 현재 하드웨어의 상태는 어떠한지, 코드가 어떻게 실행되었는지, 하드웨어 상에 어떤 문제가 있었는지 등을 상세히 알려줄 수 있기 때문에 어떤 문제가 생기면 문제 해결의 실마리를 여기서 찾을 수 있다.

즉, 운영체제를 깊이 이해하면 하드웨어와 프로그램도 더 깊이 이해할 수 있다.

### 운영체제의 심장, 커널

운영체제가 응용 프로그램에 제공하는 서비스 종류는 다양하지만, 그중에서도 핵심적인 서비스가 있다. 자원에 접근하고 조작하는 기능, 프로그램이 올바르고 안전하게 실행되게 하는 기능이 운영체제의 핵심 서비스에 속합니다. 이러한 운영체제의 핵심 서비스를 담당하는 부분을 커널이라고 한다.

운영체제가 제공하는 서비스 중 커널에 포함되지 않는 서비스도 있다. 사용자 인터페이스가 그 예시다. 사용자 인터페이스는 바탕화면과 같이 사용자가 컴퓨터와 상호작용할 수 있는 통로다.

운영체제가 제공하는 사용자 인터페이스의 종류에는 GUI와 CLI가 있다.

### 이중 모드와 시스템 호출

운영체제는 실행되는 응용 프로그램이 하드웨어 자원에 직접 접근하는 것을 방지하여 자원을 보호한다. 그래서 운영체제는 응용 프로그램들이 자원에 접근하려고 할 때 오직 자신을 통해서만 접근하도록 하여 자원을 보호한다.

이러한 운영체제의 문지기 역할은 이중 모드로써 구현된다.
이중 모드란 CPU가 명령어를 실행하는 모드를 크게 사용자 모드와 커널 모드로 구분하는 방식이다. CPU는 명령어를 사용자 모드로써 실행할 수 있고, 커널 모드로써 실행할 수 있다.

사용자 모드는 운영체제 서비스를 제공받을 수 없는 실행 모드다. 즉, 커널 영역의 코드를 실행할 수 없는 모드다. 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행된다.

반면 커널 모드는 운영체제 서비스를 제공받을 수 있는 실행 모드다. 즉, 커널 영역의 코드를 실행할 수 있는 모드다.

사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면 운영 체제에 요청을 보내 커널 모드로 전환되어야 하는데, 이 요청을 시스템 호출이라고 한다.

시스템 호출은 소프트웨어적인 인터럽트다.
특정 명령어에 의해 발생하는 것을 말한다.

따라서 시스템 호출을 발생시키는 명령어가 실행되면 CPU는 지금까지의 작업을 백업하고, 커널 영역 내에 시스템 호출을 수행하는 코드를 실행한 뒤 다시 기존에 실행하던 응용 프로그램으로 복귀하여 실행을 계속해 나간다.

### 운영체제의 핵심 서비스

#### 프로세스 관리

실행 중인 프로그램을 프로세스라고 한다. 일반적으로 하나의 CPU는 하나의 프로세스만 실행할 수 있기에 CPU는 이 프로세스들을 조금씩 번갈아 가며 실행한다. 다시 말해 CPU는 한 프로세스를 실행하다가 다른 프로세스로 실행을 전환하고, 그 프로세스를 실행하다가 또 다른 프로세스로 실행을 전환하는 것을 반복한다.

추가로, 프로세스가 동시에 실행되는 환경에서는 '프로세스 동기화'가 필수적이다. 프로세스가 더 이상 실행되지 못하는 상황인 '교착 상태'를 해결해야 한다.

#### 자원 접근 및 할당

CPU

> 일반적으로 메모리에는 여러 프로세스가 적재된다. 운영체제는 프로세스들이 공정하게 CPU를 할당하기 위해 어떤 프로세스부터 CPU를 이용하게 할 것인지, 얼마나 오래 이용하게 할 것인지를 결정할 수 있어야 한다. 이를 CPU 스케줄링이라고 한다.

메모리

> 메모리에 적재된 프로세스들은 크기도, 적재되는 주소도 가지각색이다. 같은 프로세스라 할지라도 실행할 때마다 적재되는 주소가 달라질 수 있다.

입출력장치

> 인터럽트 서비스 루틴은 운영체제가 제공하는 기능으로 커널 영역에 있다.

#### 파일 시스템 관리

컴퓨터를 사용할 때는 여러 파일을 열고, 생성하고, 삭제한다. 이 파일들을 한데 묶어 디렉터리로 관리한다. 이런 파일 시스템도 운영체제가 지원하는 핵심 서비스다.

(가상화를 지원하는 CPU는 커널 모드와 사용자 모드 이외에 가상 머신을 위한 모드인 하이퍼바이저 모드를 따로 둔다. 이게 없다면 가상 머신 위에서 돌아가는 운영체제도 결국 사용자 모드로 실행 되기 때문에 그 위에서 돌아가는 응용 프로그램에게 운영체제 서비스를 제공할 수 없다.)
