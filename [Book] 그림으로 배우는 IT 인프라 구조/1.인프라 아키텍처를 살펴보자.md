## 인프라란?

우리말로 하면 '기반'이란 뜻으로, 생활을 지탱하는 바탕이나 토대라는 의미다. 인프라 구조 자체는 복잡하지만, 전문가에 의해 관리되고 있어서 사용자는 그 구조를 이해하지 않고도 간단히 이용할 수 있다는 특징이 있다.

IT 인프라도 마찬가지로 IT의 기반이 되는 것이다.

### 인프라 아키텍처란?

아키텍처를 직역하면 '구조'라는 의미다. 인프라 아키텍처는 IT 인프라의 '구조'를 의미한다. 인터넷 검색 시스템이나 항공 회사 티켓 발권 시스템, 편의점 계산대 등 모두 IT 인프라 위에서 동작하고 있고 이 '인프라 아키텍처'는 매우 많이 닮아 있어 거의 같은 구조를 가진 채 움직이고 있다.

IT 업계에서 주류가 되고 있는 인프라 아키텍처는 다음과 같다.

1. 집약과 분할

   > 집약형, 분할형

2. 수직 분할

   > 클라이언트 - 서버형, 3계층형

3. 수평 분할

   > 단순 수평 분할형, 공유형

4. 지리 분할
   > 스탠바이 구성, 재해 대응 구성

궁극의 아키텍처와 최적의 아키텍처는 존재하는 것일까?

아키텍처나 설계 요소에는 반드시 장단점이 존재한다. 따라서 취사선택해야 할 상황이 발생한다. 가장 제약이 많은 것은 시스템 도입 비용이다. 비용을 고려해서 시스템의 가장 중요한 장점은 살리고 단점은 최소화하도록 설계하는 것이 중요하다.

### 집약형과 분할형 아키텍처

#### 집약형 아키텍처

대형 컴퓨터로 모든 것을 한다. 시스템 아키텍처라는 관점에서 하나의 컴퓨터로 모든 처리를 하면 '집약형'이라고 할 수 있다. 최대 장점은 구성이 간단하다는 것이다. 이 아키텍처에서는 주요 업무를 모두 컴퓨터 한 대로 처리하기 때문에 장비 고장 등으로 업무가 멈추지 않도록 여러 고민을 해야 한다. 또, 여러 업무 처리를 동시에 실행할 수 있어야 한다. 하나의 처리가 실수로 대량의 요청을 보내더라도 다른 처리에 영향을 주지 않도록 해야 한다. 즉, 한 대의 컴퓨터지만 안에 여러 사람이 동거하고 있는 모습이라 할 수 있다. 기업 내 핵심 업무 시스템에서 이용하고 있는 경우가 많으며 대형 컴퓨터는 도입 비용 및 유지 비용이 큰 경향이 있다. 컴퓨터의 파워가 부족하면 한 대를 별도로 구매해야 하는데 비용이 많이 든다. 확장성에도 한계가 존재한다. 현재는 가격이 싸고 확장성이 높은 분할형이 주로 사용되고 있다.

#### 분할형 아키텍처

분할형 아키텍처는 여러 대의 컴퓨터를 조합해서 하나의 시스템을 구축하는 구조다. 대형 컴퓨터는 안정성이 높고 고성능이지만, 현재는 소형 컴퓨터도 충분한 성능을 낼 수 있다. 하지만 안정성은 대형 컴퓨터에 미치지 못하기 때문에 여러 대의 컴퓨터를 이용해 한 대가 고장나도 안정성을 담보하고 있다.

분할형 아키텍처는 표준 OS나 개발 언어를 이용하기 때문에 '오픈 시스템'이라고도 부른다. 또, 여러 대의 컴퓨터를 연결해서 이용하기 때문에 '분산 시스템'이라 부르는 경우도 있다.

분할형의 장점은 개별 컴퓨터의 안정성이 낮아도 괜찮기 때문에 저가 장비를 이용해서 전체적인 비용을 줄일 수 있다는 것이다. 또한, 더 많은 컴퓨터를 이용해서 시스템 전체 성능을 향상시킬 수 있어서 확장성이 좋다는 특징도 있다. 하지만 서버 수가 늘어나면 이를 운영하기 위한 구조가 복잡해지는 경향이 있다. 또, 서버가 망가지면 영향 범위를 최소화하기 위해 서버별 역할을 세세하게 검토해야 한다. 서버를 분할하는 일반적인 방식으로는 수직형과 수평형이 있다.

#### 물리 서버와 논리 서버의 차이

분할형 아키텍처에서 이용되는 컴퓨터를 '서버'라고 한다. 서버는 하드웨어를 가리키는 경우도 있고, 컴퓨터에서 동작하고 있는 소프트웨어를 가리키는 경우도 있다.
서버라는 용어는 원래 '특정 역할에 특화된 것'을 의미한다.
예를 들어 인터넷에 접속했을 때 사용자 입력 및 HTML 생성을 담당하는 것은 서버에서 동작하는 소프트웨어인 '웹 서버'다. 대량의 데이터를 저장해서 요청에 따라 데이터를 제공하는 것은 데이터베이스 기능을 제공하는 'DB 서버'다.
컴퓨터 자체는 물리 서버라고 부른다. 인텔의 x86 서버는 인텔 아키텍처를 채용하고 있어서 IA 서버라 부른다.

#### 수직 분할형 아키텍처

분할형에서는 서버 분할 방식, 즉 역할 분담을 고려해야 한다. 각각의 서버가 전혀 다른 작업을 하는 것인지, 아니면 비슷한 작업을 하는 것인지에 대한 관점이다.

서버별로 다른 역할을 담당하는 것은 '수직 분할형 아키텍처'라고 한다. 수직인 이유는 서버 측면에서 봤을 때 역할에 따라 '위' 또는 '아래' 계층으로 나뉘기 때문이다.

##### 클라이언트-서버형 아키텍처

클라이언트-서버형은 수직 분할형의 한 예다. 업무 애플리케이션, 미들웨어, 데이터베이스 등의 소프트웨어를 '물리 서버' 상에서 운영하고 있다. 이 소프트웨어들에 '클라이언트' 또는 '단말'이라 불리는 소형 컴퓨터가 접속해서 이용하는 형태다. 영문 표기의 Client/Server의 앞글자를 따서 'C/S'라고 부르기도 한다.

클라이언트-서버형의 특징은 클라이언트 측에 전용 소프트웨어를 설치해야 한다는 것이다. 클라이언트에 주로 PC가 이용되지만, 최근에는 스마트폰이나 태블릿도 단말로 사용되고 있다. 예를 들어 주식 판매 시스템은 그래프 표시나 주가 흐름 분석은 PC에서 하고, 필요에 따라 서버에서 주가 데이터를 취득하는 방식이 많다. 이 방식에서 서버 측은 데이터 입출력만 하면 되기에 처리당 부하가 낮아서 많은 PC가 동시에 요청을 보내도 문제가 없다. 

이런 경우 기능 추가나 버그 수정을 할 때 반드시 정기적인 업데이트가 필요하다. 업무 애플리케이션 갱신 시마다 클라이언트 측 소프트웨어도 업데이트해야 한다. 이 업데이트를 이용자가 바로 하는 것이 아니기 때문에 시스템 위험 요소가 될 수 있다. 또한, 서버에 처리가 집중되면 확장성에 한계가 발생할 가능성이 있다. 이런 단점을 개선하려고 한 것이 3계층형이다.

##### 3계층형 아키텍처

3계층형은 수직 분할형의 한 가지 예인데, 클라이언트-서버형을 발전시킨 것이다. 프레젠테이션 계층, 애플리케이션 계층, 데이터 계층으로 나뉜 것을 3계층이라고 한다. 

프레젠테이션 계층에서 사용자 요청을 받아 화면에 표시한다. 
애플리케이션 계층에서 무엇을 할지 판단해서 (사용자 요청에 따라 업무 처리를 하는 것) 필요한 경우 데이터 계층에 질의한다.
데이터 계층에서 데이터 입출력을 담당한다.

3계층 시스템에서는 사용자가 웹 브라우저를 통해 시스템에 접속한다. 예를 들어, 인터넷 검색 시스템에서는 사용자가 웹 브라우저에 입력하는 화면은 프레젠테이션 계층의 웹 서버에 먼저 전달된다. 웹 서버는 해당 요청을 뒤에 있는 애플리케이션 계층의 애플리케이션 서버 (AP 서버)에 전달한다. AP 서버는 검색 키워드를 바탕으로 무엇을 검색해야 할지 판단해서 뒤에 있는 데이터 계층의 DB서버에 데이터를 요청한다.

클라이언트-서버형에 비해 특정 서버에 부하가 집중되는 문제가 해결된다는 것이 장점이며 업무 애플리케이션 갱신에 따른 클라이언트 업데이트가 필요 없다. 사용자는 웹 브라우저만 준비하면 된다. 

해당 아키텍처는 모든 처리가 AP 서버나 DB 서버를 이용할 필요가 없다. 예를 들어, 이미지 파일만 읽으면 되는 경우라면 웹 서버만으로도 처리를 완료해서 결과를 반환할 수 있으므로 다른 서버에 부하를 주지 않는다.
단, 시스템 구조가 클라이언트-서버형보다 복잡하다.

가장 일반적인 형태의 아키텍첟.

##### 수평 분할형 아키텍처

더 높은 확장성을 실현하려면 수평 분할이 필요하다. 이는 용도가 같은 서버를 늘려나가는 방식이다. 서버 대수가 늘어나면 한 대가 시스템에 주는 영향력이 낮아져서 안정성이 향상된다. 또한, 처리를 담당하는 서버 대수가 늘어나면 전체적인 성능 향상도 실현할 수 있다. 수직 분할형과 수평 분할형은 배타적인 관계가 아니고 함께 채택하는 시스템이다.

- 단순 수평 분할형 아키텍처
> 예시: 서울 본사와 부산 지사 시스템이 분할됨.
서울에서 부산 지사 정보를 알고 싶으면 부산 지사 측 시스템에 접속하면 된다. 수평 분할을 샤딩이나 파티셔닝이라 부르기도 한다.

이 구성에서는 시스템이 둘로 분할되었기 때문에 성능을 두 배로 향상시킬 수 있다. 두 개의 독립된 시스템이 생성되었기 때문에 한쪽에 장애가 발생하더라도 다른 쪽에는 전혀 영향을 주지 않는다.

하지만 두 시스템이 같은 업무 애플리케이션을 이용하고 이다면, 양쪽 시스템에 매번 애플리케이션 업데이트를 실시해 주어야 한다. 또 데이터도 따로 보유하고 있기 때문에 양쪽 데이터를 동시에 (일원화해서) 이용할 수 없다. 또한, 한쪽에 요청이 쏠린다면 다른 한쪽은 놀고 있기 때문에 성능이 2배로 늘었다고는 할 수 없다.

이 구조는 거래상으로 멀리 떨어진 시스템에 자주 이용된다. 혹은 각 거점이 완전히 독립된 운영을 하고 있는 경우에도 적합하다. 예를 들어 많은 사용자가 있는 SNS 웹 서비스에서는 사용자 ID를 기준으로 서버를 분할 (샤딩) 하는 경우가 있다.

- 공유형 아키텍처
> 공유형에서는 단순 분할형과 달리 일부 계층에서 상호 접속이 이루어진다. 예를 들어 데이터가 각지에 흩어져 있는 것보다 한곳에서 집중적으로관리하는 것이 보안이나 관리상 유리한 경우가 있다. 또한, 이 구성에서는 데이터를 모아서 참조할 수 있다. 하지만 분할한 시스템 간의 독립성이 낮아지고 공유한 계층의 확장성이 낮아진다.

#### 지리 분할형 아키텍처

업무 연속성 및 시스템 가용성을 높이기 위한 방식으로 지리적으로 분할하는 아키텍처다.

- 스탠바이형 아키텍처
> 스탠바이 구성, HA(High Availability) 구성, 액티브-스탠바이 구성 등으로 불린다. 물리 서버를 최소 두 대를 준비하여 한 대가 고장 나면 가동 중인 소프트웨어를 다른 한 대로 옮겨서 운영하는 방식이다. 이때 소프트웨어 재시작을 자동으로 하는 구조를 '페일오버(Failover)'라고 한다. F/O라고 부르기도 한다.  
이 방식에서는 물리 서버 고장에 대처할 수 있지만, 스탠바이가 놀고 있는 상태가 되기 때문에 리소스 측면에서 낭비가 발생한다. 이 문제를 해결하기 위해 스탠바이를 따로 두지 않고, 양쪽 서버를 동시에 교차 이용하는 경우도 많다.

> 물리 서버가 아닌 가상화 서버를 이용하고 있는 경우 서버상의 S/W뿐만 아니라 가상 서버별로 다른 물리 서버에 페일오버하는 방식도 선택될 수 있다.

- 재해 대책형 아키텍처
> 데이터 센터(사이트)에 있는 상용 환경에 고장이 발생하면 다른 사이트에 있는 재해 대책 환경에서 업무 처리를 재개하는 것을 가리킨다.
물리적으로 거리가 있는 두 사이트를 사용하며 문제가 되는 것은 애플리케이션 최신화와 데이터 최신화다. 매일 갱신되는 데이터가 있는데, 실시간성을 유지해서 사이트 간 동기 처리를 해야 한다. 동기 처리를 위한 방법은 여러 가지가 있다. 저장소 장비, OS, DB 기능을 사용할 수 있다. 비용, 데이터의 종류 등을 고려해서 결정할 필요가 있다.






