> 하드웨어 장비를 소재하고 그 내부에서 데이터가 어떻게 흐르고 있는지 설명

아키텍처 전체를 구상할 때는 서버라는 단위로 먼저 생각한다.
물리적인 서버는 보통 랙이라는 것에 장착된다. 랙에는 서버 외에도 HDD가 가득 장착돼 있는 저장소나 인터넷 및 LAN을 연결하기 위한 네트워크 스위치 등도 탑재돼 있다. 랙은 규격이 존재한다. 따라서 랙에 서버가 딱 맞게 설치되는 것이 가능하다.

서버 설치 시에 중요한 정보는 다음과 같다:

1. 서버 크기
2. 소비 전력
3. 중량

서버 내부에는 CPU와 메모리가 물리적으로 연결되어 있다.
또 PCI Express 슬롯이 있는데, 이것은 외부 장치를 연결하는 곳이다.
서버와 PC는 물리적으로 기본 구성이 같다. 전원이 이중화돼 있어서 장애에 강하거나 대용량 CPU나 메모리가 탑재돼 있는 정도가 PC와 다른 점이다.
따라서 각 하드웨어 제조사가 경쟁하는 것은 CPU나 메모리 등의 컴포넌트 자체를 개선하거나 컴포넌트 배치나 버스 구성, 하드웨어를 가동시키기 위한 펌웨어를 개선해서 성능을 차별화하는 것이다.

### CPU

CPU는 연산 처리를 담당한다.
애플리케이션 등 운영체제 위에서 동작하는 프로그램이 운영체제에 명령을 내리면 운영체제가 CPU에게 명령을 내린다. 이때 애플리케이션이 내리는 명령은 곧 웹 서버, 혹은 데이터베이스 등의 프로세스와 키보드, 마우스 등을 통한 입력을 의미한다.

### 메모리

메모리는 기억 영역을 말한다. 메모리는 휘발성이다.
그럼에도 불구하고 사용되는 이유는 메모리 액세스가 빠르게 이루어지기 때문이다. CPU 내부에도 캐시 메모리가 있다.

### I/O 장치

#### HDD

HDD는 메모리에 비해 CPU에서 떨어진 곳에 배치된다. 주로 장기 저장 목적의 데이터 저장소로 사용된다. 전기가 없어도 데이터가 사라지지 않는다. HDD 내부에는 자기 원반이 여러 개 들어 있다. 이것이 고속으로 회전해서 읽기/쓰기를 처리한다. 이 회전 구조 때문에 속도가 물리 법칙에 좌우되고 메모리처럼 빠른 액세스가 안 된다.
일반적으로 수밀리초에서 수십 밀리초 정도의 시간이 걸린다.
현재는 반도체의 원리를 이용한 SSD가 있다. 갈수록 메모리와 기억 장치 간 속도 차이가 없어지고 있으며 몇 년 후에는 HDD가 없어질 수 있다.
HDD가 많이 탑재돼 있는 하드웨어를 스토리지라고 한다. 저장소는 I/O의 서브 시스템이라고도 불리는 장치로 내부에는 CPU와 캐시가 존재하고 수많은 HDD 외에도 여러 장치를 탑재하고 있다.
서버와 I/O 시 HDD가 직접 데이터 교환을 하는 것이 아니라 캐시를 통해서 한다.

대형 저장소와 연결할 떄는 일반적으로 파이버 채널 (FC)라는 케이블을 사용해서 SAN이라는 네트워크를 경유한다. SAN에 접속하기 위한 파이버 채널 인터페이스를 FC포트라고 한다. 보통은 서버 시스템 포트에 FC 포트가 없기 떄문에 PCI 슬롯에 HBA라는 카드를 삽입한다.

라이트 백이란?

> 쓰기 작업을 할 때 캐시에만 쓰기 처리를 하고 종료하는 것. 속도가 빠르지만 데이터를 잃을 가능성이 있다.

라이트 스루란?

> 쓰기 작업을 할 때 캐시와 HDD에 모두 액세스한다. 캐시의 장점을 살릴 수 없다.

#### 네트워크 인터페이스

네트워크 인터페이스는 서버와 외부 장비를 연결하기 위한 것으로 외부 접속용 인터페이스다. 서버 외부 장비로는 네트워크에 연결된 다른 서버나 저장소 장치가 있다.

#### I/O 제어

요즘에는 PCH(Platform Controller Hub)와 같은 칩셋이 탑제되어 CPU가 제어하는 메모리나 PCIe 외의 처리 속도가 비교적 늦어도 용서되는 I/O 제어를 담당하고 있다.

### 버스

버스는 서버 내부에 있는 컴포넌트들을 서로 연결시키는 회선을 가리킨다.
버스에게 중요한 것은 버스가 어느 정도의 데이터 전송 능력을 갖고 있는가다.

#### 대역

대역은 원래 주파수 대역을 가리키지만, IT 인프라에서는 데이터 전송 능력을 의미한다. 대역은 '한번에 데이터를 보낼 수 있는 데이터의 폭 x 1초에 전송할 수 있는 횟수'로 결정된다.
대역은 스루풋(throughput)이라고도 부른다.

예를 들어 인터페이스 규격의 하나인 PCI Express 3.0은 1회선당 2GB/s 전송이 가능한 프로토콜이다. x8 or x16 같은 숫자는 몇 회선인지를 의미한다. 즉, x8은 8회선, x16은 16회선의 전송 능력을 가지고 있음을 의미한다. CPU에 가까운 쪽이 버스 대역이 크다.

CPU와 메모리는 대량으로 데이터를 교환해서 매우 빠른 전송 능력이 요구되기 때문에 CPU 바로 앞에 위치하고 있다. USB 3.0 포트는 약 500MB/s 전송 능력을 가진 규격으로 저속이기 때문에 PCH 앞에 배치해도 문제가 없다.

일상에서 접하는 대역으로는 광랜 인터넷을 들 수 있다. 최대 1GBps = 125MB/s 대역으로 통신이 가능함을 의미한다. CPU 간 대역은 편방향 10.4GT/s 다. 최근에는 데이터 전송 속도와 전기적 신호 속도가 다르다는 견해가 존재하여 버스 전송 속도에는 기가바이트가 아닌 기가트랜스퍼를 사용하는 경우가 늘고 있다. 10.4GT/s는 20.8GB/s의 처리와 같다.
인터넷과 비교하면 170배나 빠른 속도다.

버스 흐름에서 중요한 것은 CPU와 장치 사이에 병목 현상이 없어야 한다는 것이다. 병목 현상은 데이터 전송이 어떤 이유로 막혀 있는 상태를 의미한다. PCI Express 3.0 슬롯의 x16과 x8에서는 전송 능력 차이가 두 배가 된다. SAS 3.0 HDD의 전송 능력은 1200MB/s이기 때문에 x8 슬롯에서 7회선 이상 HDD가 동시에 I/O를 하면 PCI 버스에 병목 현상이 발생한다.

SSD는 총 3 세대가 있는데, SATA, SAS, NVMe 순이다. 각 전송 속도는 6, 12, 32Gbps다.
